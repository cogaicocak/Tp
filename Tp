
-- TeleportIslands GUI Script (Mobile & PC Support)
-- ƒê·∫∑t script n√†y v√†o StarterGui ho·∫∑c StarterPlayerScripts

local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Ki·ªÉm tra thi·∫øt b·ªã
local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled
local isTablet = UserInputService.TouchEnabled and UserInputService.KeyboardEnabled

-- Danh s√°ch c√°c ƒë·∫£o
local islands = {
    {name = "Peanut Island", position = Vector3.new(-2158.17, 38.36, -10193.24), emoji = "ü•ú"},
    {name = "Icecream Island", position = Vector3.new(-863.93, 66.08, -11019.04), emoji = "üç¶"},
    {name = "Tiki", position = Vector3.new(-16228.08, 9.32, 412.53), emoji = "üóø"},
    {name = "Haunted Castle", position = Vector3.new(-9506.11, 142.36, 5526.04), emoji = "üëª"},
    {name = "CakeLoaf", position = Vector3.new(-2145.42, 38.06, -11895.08), emoji = "üç∞"},
    {name = "Castle On The Sea", position = Vector3.new(-4999.45, 314.78, -3010.54), emoji = "üè∞"}
}

-- T·∫°o GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "IslandTeleportGUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Frame ch√≠nh v·ªõi k√≠ch th∆∞·ªõc responsive
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
if isMobile then
    mainFrame.Size = UDim2.new(0.9, 0, 0.7, 0) -- 90% chi·ªÅu r·ªông, 70% chi·ªÅu cao
    mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
else
    mainFrame.Size = UDim2.new(0, 320, 0, 450)
    mainFrame.Position = UDim2.new(0.5, -160, 0.5, -225)
end
mainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

-- Bo g√≥c cho frame
local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 12)
mainCorner.Parent = mainFrame

-- Stroke (vi·ªÅn) cho frame
local mainStroke = Instance.new("UIStroke")
mainStroke.Color = Color3.fromRGB(70, 70, 90)
mainStroke.Thickness = 2
mainStroke.Parent = mainFrame

-- Title
local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "Title"
titleLabel.Size = UDim2.new(1, 0, 0, isMobile and 60 or 50)
titleLabel.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
titleLabel.BorderSizePixel = 0
titleLabel.Text = "üèùÔ∏è Island Teleporter"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextSize = isMobile and 22 or 20
titleLabel.Font = Enum.Font.GothamBold
titleLabel.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 12)
titleCorner.Parent = titleLabel

-- Toggle Button (ƒë·ªÉ ·∫©n/hi·ªán GUI tr√™n mobile)
local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
if isMobile then
    toggleButton.Size = UDim2.new(0, 60, 0, 60)
    toggleButton.Position = UDim2.new(1, -70, 0, 10)
else
    toggleButton.Size = UDim2.new(0, 50, 0, 50)
    toggleButton.Position = UDim2.new(0, 10, 0, 10)
end
toggleButton.AnchorPoint = Vector2.new(0, 0)
toggleButton.BackgroundColor3 = Color3.fromRGB(50, 150, 250)
toggleButton.BorderSizePixel = 0
toggleButton.Text = "üèùÔ∏è"
toggleButton.TextSize = isMobile and 30 or 25
toggleButton.Font = Enum.Font.GothamBold
toggleButton.ZIndex = 10
toggleButton.Parent = screenGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(1, 0)
toggleCorner.Parent = toggleButton

local toggleStroke = Instance.new("UIStroke")
toggleStroke.Color = Color3.fromRGB(255, 255, 255)
toggleStroke.Thickness = 2
toggleStroke.Parent = toggleButton

-- Close Button
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, isMobile and 50 or 40, 0, isMobile and 50 or 40)
closeButton.Position = UDim2.new(1, isMobile and -55 or -45, 0, isMobile and 5 or 5)
closeButton.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
closeButton.BorderSizePixel = 0
closeButton.Text = "‚úï"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = isMobile and 24 or 20
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = mainFrame

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 8)
closeCorner.Parent = closeButton

-- ScrollingFrame cho danh s√°ch ƒë·∫£o
local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Name = "IslandList"
scrollFrame.Size = UDim2.new(1, isMobile and -30 or -20, 1, isMobile and -80 or -70)
scrollFrame.Position = UDim2.new(0, isMobile and 15 or 10, 0, isMobile and 70 or 60)
scrollFrame.BackgroundTransparency = 1
scrollFrame.BorderSizePixel = 0
scrollFrame.ScrollBarThickness = isMobile and 8 : 6
scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 120)
scrollFrame.Parent = mainFrame

local listLayout = Instance.new("UIListLayout")
listLayout.Padding = UDim.new(0, isMobile and 12 or 8)
listLayout.SortOrder = Enum.SortOrder.LayoutOrder
listLayout.Parent = scrollFrame

-- Bi·∫øn ƒë·ªÉ ki·ªÉm so√°t tween
local currentTween = nil
local isTweening = false

-- H√†m tween m∆∞·ª£t m√† ƒë·∫øn ƒë·∫£o
local function teleportToIsland(targetPosition)
    if isTweening then
        warn("ƒêang di chuy·ªÉn, vui l√≤ng ƒë·ª£i!")
        return
    end
    
    -- C·∫≠p nh·∫≠t character v√† HumanoidRootPart
    character = player.Character
    if not character then return end
    humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    isTweening = true
    
    -- T√≠nh kho·∫£ng c√°ch ƒë·ªÉ x√°c ƒë·ªãnh th·ªùi gian tween
    local distance = (targetPosition - humanoidRootPart.Position).Magnitude
    local tweenSpeed = 350 -- T·ªëc ƒë·ªô studs/gi√¢y
    local tweenTime = distance / tweenSpeed
    
    -- T·∫°o TweenInfo v·ªõi easing m∆∞·ª£t m√†
    local tweenInfo = TweenInfo.new(
        tweenTime,
        Enum.EasingStyle.Linear, -- Linear ƒë·ªÉ t·ªëc ƒë·ªô ƒë·ªÅu
        Enum.EasingDirection.Out,
        0,
        false,
        0
    )
    
    -- T·∫°o tween cho CFrame (kh√¥ng b·ªã gi·∫≠t do xyz kh√°c nhau)
    local goal = {CFrame = CFrame.new(targetPosition)}
    
    -- H·ªßy tween c≈© n·∫øu c√≥
    if currentTween then
        currentTween:Cancel()
    end
    
    currentTween = TweenService:Create(humanoidRootPart, tweenInfo, goal)
    
    -- X·ª≠ l√Ω khi tween ho√†n th√†nh
    currentTween.Completed:Connect(function(playbackState)
        isTweening = false
        currentTween = nil
        print("ƒê√£ ƒë·∫øn ƒë·∫£o!")
    end)
    
    currentTween:Play()
end

-- T·∫°o button cho m·ªói ƒë·∫£o
for i, island in ipairs(islands) do
    local islandButton = Instance.new("TextButton")
    islandButton.Name = island.name
    islandButton.Size = UDim2.new(1, isMobile and -15 or -10, 0, isMobile and 60 : 50)
    islandButton.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
    islandButton.BorderSizePixel = 0
    islandButton.AutoButtonColor = false
    islandButton.Text = ""
    islandButton.Parent = scrollFrame
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 10)
    buttonCorner.Parent = islandButton
    
    local buttonStroke = Instance.new("UIStroke")
    buttonStroke.Color = Color3.fromRGB(70, 70, 90)
    buttonStroke.Thickness = 1
    buttonStroke.Transparency = 0.5
    buttonStroke.Parent = islandButton
    
    -- Icon emoji
    local emojiLabel = Instance.new("TextLabel")
    emojiLabel.Size = UDim2.new(0, isMobile and 50 or 40, 1, 0)
    emojiLabel.Position = UDim2.new(0, 5, 0, 0)
    emojiLabel.BackgroundTransparency = 1
    emojiLabel.Text = island.emoji
    emojiLabel.TextSize = isMobile and 28 or 24
    emojiLabel.Parent = islandButton
    
    -- T√™n ƒë·∫£o
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, isMobile and -65 or -55, 1, 0)
    nameLabel.Position = UDim2.new(0, isMobile and 60 or 50, 0, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = island.name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextSize = isMobile and 18 or 16
    nameLabel.Font = Enum.Font.GothamSemibold
    nameLabel.TextXAlignment = Enum.TextXAlignment.Left
    nameLabel.Parent = islandButton
    
    -- Hi·ªáu ·ª©ng hover (ch·ªâ cho PC)
    if not isMobile then
        islandButton.MouseEnter:Connect(function()
            if not isTweening then
                TweenService:Create(islandButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(70, 70, 90)}):Play()
                TweenService:Create(buttonStroke, TweenInfo.new(0.2), {Thickness = 2, Transparency = 0}):Play()
            end
        end)
        
        islandButton.MouseLeave:Connect(function()
            TweenService:Create(islandButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(50, 50, 65)}):Play()
            TweenService:Create(buttonStroke, TweenInfo.new(0.2), {Thickness = 1, Transparency = 0.5}):Play()
        end)
    end
    
    -- X·ª≠ l√Ω click
    islandButton.MouseButton1Click:Connect(function()
        if not isTweening then
            -- Hi·ªáu ·ª©ng click
            TweenService:Create(islandButton, TweenInfo.new(0.1), {BackgroundColor3 = Color3.fromRGB(80, 180, 80)}):Play()
            teleportToIsland(island.position)
            wait(0.3)
            TweenService:Create(islandButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(50, 50, 65)}):Play()
        end
    end)
end

-- C·∫≠p nh·∫≠t canvas size
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + (isMobile and 20 or 10))
listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + (isMobile and 20 or 10))
end)

-- X·ª≠ l√Ω toggle button
local isGuiVisible = true
toggleButton.MouseButton1Click:Connect(function()
    isGuiVisible = not isGuiVisible
    mainFrame.Visible = isGuiVisible
    
    -- Hi·ªáu ·ª©ng cho toggle button
    local targetColor = isGuiVisible and Color3.fromRGB(50, 150, 250) or Color3.fromRGB(100, 100, 120)
    TweenService:Create(toggleButton, TweenInfo.new(0.3), {BackgroundColor3 = targetColor}):Play()
end)

-- X·ª≠ l√Ω n√∫t ƒë√≥ng
closeButton.MouseButton1Click:Connect(function()
    isGuiVisible = false
    mainFrame.Visible = false
    TweenService:Create(toggleButton, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(100, 100, 120)}):Play()
end)

-- L√†m frame c√≥ th·ªÉ k√©o (ch·ªâ cho PC/Tablet)
if not isMobile or isTablet then
    local dragging
    local dragInput
    local dragStart
    local startPos

    local function update(input)
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end

    titleLabel.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    titleLabel.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
end

-- Hi·ªáu ·ª©ng xu·∫•t hi·ªán
mainFrame.Size = UDim2.new(0, 0, 0, 0)
mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)

wait(0.1)

local targetSize = isMobile and UDim2.new(0.9, 0, 0.7, 0) or UDim2.new(0, 320, 0, 450)
local targetPos = UDim2.new(0.5, 0, 0.5, 0)

TweenService:Create(mainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
    Size = targetSize,
    Position = targetPos
}):Play()

-- X·ª≠ l√Ω khi character respawn
player.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
    humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    isTweening = false
    if currentTween then
        currentTween:Cancel()
        currentTween = nil
    end
end)

print("Island Teleporter GUI ƒë√£ load th√†nh c√¥ng! (Mobile & PC Support)")
